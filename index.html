<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ContrÃ´le LED ESP32</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #222;
      color: white;
    }
    /* Style du titre interactif */
    h2 {
      font-size: 32px;
      transition: all 0.3s ease;
    }
    /* Animation pour le mode stroboscope */
    .strobe {
      animation: strobeAnim 1s infinite;
    }
    @keyframes strobeAnim {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    button, .mode-btn, .multiplier-btn {
      margin: 10px;
      padding: 15px;
      font-size: 18px;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover, .mode-btn:hover, .multiplier-btn:hover {
      background: #0056b3;
    }
    input[type="color"], input[type="number"] {
      width: 100px;
      height: 40px;
      border: none;
      cursor: pointer;
    }
    .modes, .bpm-section {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .bpm-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <!-- Titre interactif -->
  <h2 id="title">ContrÃ´le des LEDs ESP32</h2>

  <div class="container">
    <!-- Palette de couleur -->
    <div>
      <label>Choisissez une couleur :</label>
      <input type="color" id="colorPicker" value="#ff0000">
      <button onclick="applyColor()">ðŸŽ¨ Appliquer Couleur</button>
    </div>

    <!-- Modes d'effets -->
    <h3>Modes d'effets</h3>
    <div class="modes">
      <div class="mode-btn" onclick="selectEffect('rainbow')">ðŸŒˆ Arc-en-Ciel</div>
      <div class="mode-btn" onclick="selectEffect('flash')">âš¡ Flash RGB</div>
      <div class="mode-btn" onclick="selectEffect('wave')">ðŸŒŠ Effet Vague</div>
      <div class="mode-btn" onclick="selectEffect('pulse')">ðŸ’“ Pulsation</div>
      <div class="mode-btn" onclick="selectEffect('strobe')">ðŸ”¦ Stroboscope</div>
    </div>

    <!-- Section BPM et multiplicateurs -->
    <h3>BPM & Multiplicateurs</h3>
    <div class="bpm-section">
      <label>
        <input type="checkbox" id="bpmToggle"> Activer BPM
      </label>
      <div class="bpm-controls" id="bpmControls" style="display: none;">
        <input type="number" id="bpmInput" placeholder="BPM" value="120">
        <div class="multiplier-btn" onclick="setMultiplier(0.25)">x1/4</div>
        <div class="multiplier-btn" onclick="setMultiplier(0.5)">x1/2</div>
        <div class="multiplier-btn" onclick="setMultiplier(1)">x1</div>
        <div class="multiplier-btn" onclick="setMultiplier(2)">x2</div>
        <div class="multiplier-btn" onclick="setMultiplier(4)">x4</div>
      </div>
    </div>
  </div>

  <script>
    // Variables globales pour suivre l'Ã©tat
    let currentEffect = '';
    let currentMultiplier = 1;
    let currentBPM = 120;

    // Active ou dÃ©sactive la section BPM en fonction de la case Ã  cocher
    document.getElementById('bpmToggle').addEventListener('change', function() {
      document.getElementById('bpmControls').style.display = this.checked ? 'flex' : 'none';
    });

    // Appliquer la couleur sÃ©lectionnÃ©e et mettre Ã  jour le titre
    function applyColor() {
      const color = document.getElementById("colorPicker").value;
      console.log("Couleur envoyÃ©e:", color);
      updateTitleStyle({ color: color });
      // Exemple d'envoi vers l'ESP32 : 
      // fetch(`/color?r=${parseInt(color.substr(1,2),16)}&g=${parseInt(color.substr(3,2),16)}&b=${parseInt(color.substr(5,2),16)}`);
    }

    // SÃ©lectionner un effet et mettre Ã  jour l'apparence du titre
    function selectEffect(effect) {
      const titleEl = document.getElementById('title');
      // Supprimer toute classe ou style d'effet prÃ©cÃ©dent
      titleEl.classList.remove('strobe');
      titleEl.style.animation = '';
      titleEl.style.color = "white";
      
      currentEffect = effect;
      titleEl.textContent = "Effet: " + effect;
      
      // Appliquer un style spÃ©cifique selon l'effet
      if (effect === 'strobe') {
        titleEl.classList.add('strobe');
      } else if (effect === 'flash') {
        titleEl.style.color = "#ffff00"; // Jaune pour flash
      } else if (effect === 'wave') {
        titleEl.style.color = "#00ffff"; // Cyan pour vague
      } else if (effect === 'pulse') {
        titleEl.style.color = "#ff00ff"; // Magenta pour pulsation
      }
      
      // Exemple d'envoi vers l'ESP32 : 
      // fetch(`/effect?name=${effect}`)
      //   .then(response => console.log("Effet envoyÃ©:", effect));
    }

    // DÃ©finir le multiplicateur BPM et mettre Ã  jour le titre
    function setMultiplier(multiplier) {
      currentMultiplier = multiplier;
      currentBPM = document.getElementById("bpmInput").value;
      const titleEl = document.getElementById('title');
      titleEl.textContent = "Effet: " + currentEffect + " | BPM: " + currentBPM + " x" + currentMultiplier;
      console.log("BPM rÃ©glÃ© sur:", currentBPM, "Multiplicateur:", currentMultiplier);
      
      // Exemple d'envoi vers l'ESP32 : 
      // fetch(`/bpm?value=${currentBPM}&multiplier=${currentMultiplier}`)
      //   .then(response => console.log("BPM envoyÃ©"));
    }

    // Mettre Ã  jour le style du titre (par exemple la couleur)
    function updateTitleStyle(options) {
      const titleEl = document.getElementById('title');
      if (options.color) {
        titleEl.style.color = options.color;
      }
    }
  </script>
</body>
</html>
